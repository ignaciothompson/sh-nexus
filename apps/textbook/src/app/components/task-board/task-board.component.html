<div class="board-container">
    <div class="board-header">
        <h2>Project Planner</h2>
        <button class="btn btn-primary" (click)="openCreateModal()">
            <span class="material-symbols-outlined">add</span> New Task </button>
    </div>
    <div class="board-columns"> @for (column of columns; track column.id) { <div class="column" [class.column-todo]="column.id === 'todo'" [class.column-inprogress]="column.id === 'in_progress'" [class.column-done]="column.id === 'done'" (dragover)="onDragOver($event)" (drop)="onDrop($event, column.id)">
            <div class="column-header">
                <div class="column-title">
                    <span>{{ column.title }}</span>
                    <span class="task-count">{{ column.tasks.length }}</span>
                </div>
            </div>
            <div class="column-body"> @for (task of column.tasks; track task.id) { <div class="task-card" draggable="true" (dragstart)="onDragStart($event, task)" (dragend)="onDragEnd($event)" (click)="openEditModal(task)">
                    <div class="task-title">{{ task.title }}</div>
                    <div class="task-meta">
                        <div class="due-date" [class.overdue]="isOverdue(task)"> @if (task.due_date) { <span class="material-symbols-outlined icon-sm" style="font-size: 1rem;">calendar_today</span> {{ task.due_date | date:'MV dd' }} } </div>
                        <button class="btn-icon" style="width: 24px; height: 24px;" (click)="$event.stopPropagation(); deleteTask(task.id)">
                            <span class="material-symbols-outlined icon-sm">close</span>
                        </button>
                    </div>
                </div> } <button class="add-btn" (click)="openCreateModal()"> + Add item </button>
            </div>
        </div> } </div>
</div>
<!-- Task Modal --> @if (showModal) { <div class="modal-overlay" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
        <h3 style="margin-bottom: var(--space-4);">{{ editingTask ? 'Edit Task' : 'New Task' }}</h3>
        <div class="form-group">
            <label class="form-label">Title</label>
            <input type="text" class="input-field" [(ngModel)]="formData.title" placeholder="What needs to be done?">
        </div>
        <div class="form-group">
            <label class="form-label">Description</label>
            <textarea class="input-field" [(ngModel)]="formData.description" rows="3" placeholder="Add some details..."></textarea>
        </div>
        <div class="form-group">
            <label class="form-label">Due Date</label>
            <input type="date" class="input-field" [(ngModel)]="formData.due_date">
        </div>
        <div class="form-group">
            <label class="form-label">Status</label>
            <select class="input-field" [(ngModel)]="formData.status" style="appearance: auto; background-color: var(--bg-card);">
                <option value="todo">To Do</option>
                <option value="in_progress">In Progress</option>
                <option value="done">Done</option>
            </select>
        </div>
        <div class="form-actions">
            <button class="btn btn-secondary" (click)="closeModal()">Cancel</button>
            <button class="btn btn-primary" (click)="saveTask()">Save Task</button>
        </div>
    </div>
</div> }